<!DOCTYPE html>
<html>

<head>
    <title>Creative</title>
    <meta charset="utf8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="css/creative.css" />
    <style>
        form {
            background-color: #f5f5f5;
            width: 300px;
            margin: 0 auto;
            padding: 20px;
            box-sizing: border-box;
        }

        #creative {
            width: 300px;
            height: 250px;
            margin: 20px auto
        }
    </style>
</head>

<body>

    <div id="creative"></div>

    <form id="settingForm">

        <p>
            <label>
                <input type="checkbox" name="openNewTab" checked /> M·ªü link trong tab m·ªõi
            </label>
        </p>

        <p>
            <label>
                <input type="checkbox" name="displayVideoText" /> Hi·ªÉn th·ªã ph·∫ßn text m√¥ t·∫£
            </label>
        </p>

        <p>
            <label>
                <input type="checkbox" name="redirectButton" disabled /> Hi·ªÉn th·ªã N√∫t ƒëi·ªÅu h∆∞·ªõng
            </label>
        </p>

        <p>
            <label>N·ªôi dung c·ªßa N√∫t ƒëi·ªÅu h∆∞·ªõng</label><br />
            <input type="text" name="redirectButtonText" value="üòÄ" disabled />
        </p>

        <p>
            <label>S·ªë l·∫ßn ph√°t l·∫°i video</label><br />
            <input type="number" name="limitNumberRepeat" min="-1" value="-1" /> <br />
            <small style="color: #666;">-1: l·∫∑p v√¥ h·∫°n, 0 l√† kh√¥ng l·∫∑p</small>
        </p>

        <p>
            <label>Th·ªùi gian ch·ªù ph√°t l·∫°i</label><br />
            <input type="number" name="delayRepeat" min="0" value="3000" step="500" /> <br />
            <small style="color: #666;">ƒë∆°n v·ªã t√≠nh miliseconds (3000ms = 3s)</small>
        </p>

        <button type="submit">C·∫≠p nh·∫≠t thay ƒë·ªïi</button>
        <button type="button" name="btnTest">T·∫Øt qu·∫£ng c√°o</button>

    </form>

    <script src="js/hls.min.js"></script>
    <script src="js/creative.js?v=1.0.4"></script>

    <script>

        (function () {

            var settingForm = document.getElementById('settingForm');

            var settings = {

                // id c·ªßa th·∫ª html s·∫Ω render qu·∫£ng c√°o
                targetId: "creative",

                // l·ª±a ch·ªçn c√≥ hi·ªÉn th·ªã text ph√≠a d∆∞·ªõi video 
                // m·∫∑c ƒë·ªãnh: true
                displayVideoText: false,

                // hi·ªÉn th·ªã button ƒëi·ªÅu h∆∞·ªõng
                // ch·ªâ ph√π h·ª£p khi displayVideoText = true
                // m·∫∑c ƒë·ªãnh: true
                redirectButton: true,

                // n·ªôi dung c·ªßa button 
                // m·∫∑c ƒë·ªãnh: Go!
                redirectButtonText: "",

                // true: m·ªü link trong tab m·ªõi, 
                // false: m·ªü tab hi·ªán t·∫°i
                // m·∫∑c ƒë·ªãnh: true
                openNewTab: true,

                // s·ªë l·∫ßn ph√°t l·∫°i video
                // m·∫∑c ƒë·ªãnh: -1
                limitNumberRepeat: -1,

                // th·ªùi gian ch·ªù tr∆∞·ªõc khi ph√°t l·∫°i (ƒë∆°n v·ªã miliseconds)
                // m·∫∑c ƒë·ªãnh: 3 gi√¢y (3000ms)
                delayRepeat: 3000,

                // thu·ªôc t√≠nh c·ªßa video
                video: {
                    source: "https://playertest.longtailvideo.com/adaptive/customIV/prog_index.m3u8",
                    thumbnail: "http://report.bidgear-syndication.com/test/thuan/img/thumb2.jpg",
                    text: "There are many variations of passages",
                    link: "https://laravel.com/",
                },
            };

            var creative = new Creative(settings);
            // creative.debug = true;

            creative.on(Creative.Events.VIDEO_START_FIRST_TIME, function(data){
                console.log("Creative.Events.VIDEO_START_FIRST_TIME", data);
            });

            creative.on(Creative.Events.VIDEO_ENDED_FIRST_TIME, function(data){
                console.log("Creative.Events.VIDEO_ENDED_FIRST_TIME", data);
            });

            creative.on(Creative.Events.DESTROY, function(data){
                console.log("Creative.Events.DESTROY", data);
            });

            creative.display();

            settingForm.onsubmit = function (event) {
                event.preventDefault();

                loadFormData(this);

                creative.loadConfig(settings);

                creative.display();
            }

            settingForm.displayVideoText.addEventListener("change", function () {
                if (!this.checked) {
                    settingForm.redirectButton.setAttribute("disabled", "disabled");
                    settingForm.redirectButtonText.setAttribute("disabled", "disabled");
                } else {
                    settingForm.redirectButton.removeAttribute("disabled");

                    if (settingForm.redirectButton.checked) {
                        settingForm.redirectButtonText.removeAttribute("disabled");
                    }
                }
            });

            settingForm.redirectButton.addEventListener("change", function () {
                if (!this.checked) {
                    settingForm.redirectButtonText.setAttribute("disabled", "disabled");
                } else {
                    settingForm.redirectButtonText.removeAttribute("disabled");
                }
            });

            settingForm.btnTest.addEventListener("click", function () {
                creative.destroy();
            })

            function loadFormData(form) {
                settings.displayVideoText = form.displayVideoText.checked;
                settings.redirectButton = form.redirectButton.checked;
                settings.redirectButtonText = form.redirectButtonText.value;
                settings.openNewTab = form.openNewTab.checked;
                settings.limitNumberRepeat = parseInt(form.limitNumberRepeat.value, 10);
                settings.delayRepeat = parseInt(form.delayRepeat.value, 10);
            }
            
        })();

    </script>

</body>

</html>